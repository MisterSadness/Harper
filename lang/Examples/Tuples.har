index :: Iterable a -> Iterable (a, Integer);
index xs = {
  var (i :: Integer) = 0;
  for (x :: a) in xs {
    yield (x, i);
	  i += 1;
  }
};

map :: (a -> b) -> Iterable a -> Iterable b;
map f xs = {
  for (x :: a) in xs {
    yield f x;
  }
};

filter :: (a -> Bool) -> Iterable a -> Iterable a;
filter f xs = {
  for (x :: a) in xs {
    if f x {
	    yield x;
	  }
  }
};

decimate :: Iterable a -> Integer -> Iterable a;
decimate xs n = {
  (ixs :: Iterable (a, Integer)) = index xs;
  /* A lambda expression using pattern-matching to extract from a tuple. */
  (f :: (a, Integer) -> Bool) = \(_, (i :: Integer)) => i mod n != 0;
  (x :: Iterable (a, Integer)) = filter f ixs;
  (y :: Iterable (a, b) -> Iterable a) = map fst;
  return map fst | filter f ixs;
};

fst :: (a, b) -> a;
fst t = match t {
  ((a :: a), _) => a
};